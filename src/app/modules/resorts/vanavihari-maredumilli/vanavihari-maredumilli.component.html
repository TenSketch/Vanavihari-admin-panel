<app-layout>
  <div class="main">
    <section class="page-banner d-grid place-items-center">
      <h1 class="display-3 text-center">Vanavihari, Maredumilli</h1>
    </section>

    <div class="container">
      <nav aria-label="breadcrumb">
        <ol class="breadcrumb">
          <li class="breadcrumb-item"><a href="#">Home</a></li>
          <!-- <li class="breadcrumb-item"><a href="#">Resorts</a></li> -->
          <li class="breadcrumb-item active" aria-current="page">
            Vanavihari, Maredumilli
          </li>
        </ol>
      </nav>
      <div class="row">
        <div class="col-md-4">
          <div class="map-container">
            <iframe
              src="https://www.google.com/maps/embed?pb=!1m14!1m8!1m3!1d15212.133581651236!2d81.712357!3d17.601149!3m2!1i1024!2i768!4f13.1!3m3!1m2!1s0x3a373b5d52758873%3A0x718f2b2059db5e0a!2sVanavihari%20Maredumilli!5e0!3m2!1sen!2sin!4v1708738599849!5m2!1sen!2sin"
              width="400" height="300" style="border: 0" allowfullscreen="" loading="lazy"
              referrerpolicy="no-referrer-when-downgrade"></iframe>
          </div>
        </div>
        <div class="col-md-8 mt-4 mt-lg-0">
          <h4>About Vanavihari, Maredumilli</h4>
          <p>
            Vanavihari resort, situated in the serene landscapes of Maredumilli,
            beckons eco-tourism aficionados with its abundance of bamboo trees.
            This guesthouse, committed to community well-being, offers a serene
            retreat amidst natural surroundings. With its snug cottages and
            rooms, it conveniently lies close to Amruthathara Waterfalls,
            promising guests a peaceful ambiance. Nearby street food eateries
            present the opportunity to savor the distinctive flavor of bamboo
            biriyani. Stepping out for a night or morning stroll unveils a
            heavenly experience for visitors.
          </p>
        </div>
      </div>
      <h2 class="text-center mb-4">Modify Search</h2>
      <!-- section for search bar - with inputs given in home page search, and user can modify -->
      <app-search-resort></app-search-resort>
      <!-- rooms listing section -->
      <div class="row mt-5">
        <aside class="position-sticky col-md-3 h-100">
          <!-- <section class="position-sticky"> -->
            <div class="sort rounded-3 p-3 d-none">
              <h4>Cottage Type</h4>
              <mat-checkbox id="hilltop">Hilltop Guest House</mat-checkbox><br>
              <mat-checkbox id="pre-fabricated">Pre-Fabricated Cottages</mat-checkbox><br>
              <mat-checkbox id="wooden">Wooden Cottages</mat-checkbox><br>
              <mat-checkbox id="deluxe">Deluxe Rooms</mat-checkbox><br>
              <mat-checkbox id="tented">Tented Cottages</mat-checkbox><br><br><br>
              <mat-form-field>
                <mat-label>Sort by Price</mat-label>
                <mat-select [(value)]="selectedSortOption" name="priceSort">
                  <mat-option value="lowToHigh">Low to High</mat-option>
                  <mat-option value="highToLow">High to Low</mat-option>
                </mat-select>
              </mat-form-field>
            </div>
            <!-- Booking Summary section -->
            <div class="booking-summary-bar bg-white text-dark rounded-3 p-3">
              <h4 class="mb-3 pb-2 font-weight-bold">Booking Summary</h4>
              <div class="mb-2">
                <h5 class="text-primary-dark pb-1"><strong class="me-2">Hill Top Guest House</strong></h5>
                <div class="row">
                  <i class="fa fa-trash float-end"></i>
                  <h6><strong class="me-2">Room Bonnet</strong></h6>
                  <div>2 Adult, 1 Child, 1 Extra Guest</div>
                </div>
              </div>
              <hr/>
              <div class="d-flex justify-content-between">
                <span><strong>Room Tariff</strong></span>
                <span>INR 2,500.00</span>
              </div>
              <div class="d-flex justify-content-between border-bottom border-primary pb-2">
                <span><strong>GST @ 12%</strong></span>
                <span>INR 300.00</span>
              </div>
              <div class="d-flex justify-content-between font-weight-bold py-1">
                <span class="mb-0">Total</span>
                <span>INR 3,000.00</span>
              </div>
              <div class="d-flex justify-content-between border-top border-bottom border-primary py-2 font-weight-bold text-secondary h5">
                <span class="mb-0">Grand Total</span>
                <span>INR 3,000.00</span>
              </div>
              <button mat-raised-button color="primary" class="w-100 mt-3" disabled>
                Proceed
              </button>
            </div>
            <div class="booking-summary-bar" *ngIf="showBookingSummary; else noBookings">
              <div *ngFor="let roomId of roomIds" class="card mb-3 p-2">
                <div class="row align-items-center">
                  <div class="col-md-10">
                    <p>{{ roomId.cottage_type }}</p>
                  </div>
                  <div class="col-md-2 text-end">
                    <a href="javascript:void(0)" (click)="removeRoom(roomId, roomId.id)"><i class="fa fa-trash"></i></a>
                  </div>
                  <div class="col-md-12">
                    <b>{{ roomId.name }}</b> : {{ roomId.adult_count }} Adult{{ roomId.adult_count>1?'s':'' }}
                    {{ roomId.child_count?', '+roomId.child_count+' Child'+(roomId.child_count>1?'s':''):'' }}
                    {{ roomId.guest_count?', '+roomId.guest_count+' Guest'+(roomId.guest_count>1?'s':''):'' }}
                  </div>
                  <div class="col-md-12 text-end">
                    <b>Charges:</b> {{ roomId.weekDayPrice | currency:'INR':'symbol':'1.2-2' }}
                  </div>
                </div>
              </div>
            
              <div class="row align-items-center px-3">
                Total Room Price: {{ calculateTotalPrice() | currency:'INR':'symbol':'1.2-2' }} + GST @12%
                <button class="btn btn-primary float-end" (click)="goToBooking()">Proceed</button>
              </div>
            </div>
            <ng-template #noBookings>
              <!-- <div class="text-center mt-3">
                <p>No Bookings Available. Please Add Rooms.</p>
              </div> -->
              <h5 class="text-center"><u>Booking Summary</u></h5>
              <div class="d-flex my-2 p-3 align-items-center justify-content-around">
                <i class="fa fa-plus" aria-hidden="true"></i>
                <p>Add your preferred rooms
                </p>
              </div>
              <button mat-raised-button color="primary" class="w-100" disabled>
                Proceed
              </button>
            </ng-template>
          <!-- </section> -->
        </aside>
        <main class="rooms-listing col-md-9">
          <ng-template #loading>
            <div class="text-center">
              <!-- Increase size using Bootstrap utility classes -->
              <div class="spinner-border text-primary" role="status" style="width: 4rem; height: 4rem;">
                <span class="visually-hidden">Loading...</span>
              </div>
              <p>Loading rooms...</p>
            </div>
          </ng-template>

          
          <div *ngIf="!loadingRooms; else loading">
            <div class="card mb-3 p-1" *ngFor="let room of roomCards" >
              <div class="row g-0 d-flex ">
                <div class="col-md-3 p-2">
                  <img [src]="room.image" alt="Resort Room image">
                </div>
                <div class="col-md-9 p-3 ps-0 row m-0">
                  <div class="col-md-8">
                    <h3>{{ room.name }}</h3>
                    <h6>{{ room.cottage_type }}, {{ room.resort }}</h6>
                      <!-- <select name="" class="form-select w-25" id="">
                        <option value="">1</option>
                        <option value="">2</option>
                      </select> -->
                      <!-- <mat-form-field>
                        <mat-label>Guests</mat-label>
                        <select matNativeControl required [formControl]="selected">
                          <option value="one">1</option>
                          <option value="two">2</option>
                        </select>
                        <mat-hint>2 guests max, including children.</mat-hint>
                      </mat-form-field>
                      <mat-checkbox [(ngModel)]="isChecked">Extra adult/child over 5</mat-checkbox> -->
                  </div>
                  <div class="col-md-4 text-end">
                    <h6 class="p-0 m-0"><strong>{{ room.week_day_rate | currency: 'INR': true: '1.2-2' }} + gst @ 12%</strong></h6>
                    <small>All (for {{ room.max_adult }} guests)</small>
                    <div><strong>{{ room.week_day_bed_charge | currency: 'INR': true: '1.2-2' }} + gst @ 12%</strong></div>
                    <small>(for 1 Extra Bed)</small>
                  </div>
                  <div class="col-md-12">
                    <button class="btn btn-primary w-25 float-end" (click)="addRoom(room)" [disabled]="room.is_button_disabled">
                      Add room
                    </button>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </main>
      </div>
    </div>
  </div>
</app-layout>